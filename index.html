<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NEXA GLOBAL | Ø§Ù„Ù…ÙØ§Ø¹Ù„ Ø§Ù„Ø³ÙŠØ§Ø¯ÙŠ Ø§Ù„Ø´Ø§Ù…Ù„</title>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/crypto-js.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/ethers/5.7.2/ethers.umd.min.js"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700;900&family=Orbitron:wght@700;900&display=swap" rel="stylesheet">

    <style>
        :root {
            --nexa-blue: #1877f2; --nexa-dark: #050a14; --nexa-green: #42b72a; 
            --nexa-red: #f02849; --nexa-gold: #f7b928; --bg: #f0f2f5; --white: #ffffff;
        }

        * { box-sizing: border-box; margin: 0; padding: 0; }
        body { background: var(--bg); font-family: 'Cairo', sans-serif; height: 100vh; overflow: hidden; display: flex; flex-direction: column; }

        /* --- Header --- */
        header {
            background: var(--white); height: 65px; display: flex; justify-content: space-between;
            align-items: center; padding: 0 25px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); z-index: 1000;
        }
        .logo { font-family: 'Orbitron'; font-size: 1.8rem; color: var(--nexa-blue); font-weight: 900; }

        /* --- Main Grid Layout --- */
        .main-grid { display: grid; grid-template-columns: 280px 1fr 340px; height: calc(100vh - 65px); }

        /* Sidebar Navigation */
        nav.sidebar { padding: 20px; background: var(--white); border-left: 1px solid #ddd; }
        .nav-item { 
            display: flex; align-items: center; padding: 12px; border-radius: 10px; 
            cursor: pointer; transition: 0.2s; margin-bottom: 5px; font-weight: 700; color: #4b4b4b;
        }
        .nav-item:hover, .nav-item.active { background: var(--nexa-soft-blue); color: var(--nexa-blue); }
        .nav-item i { margin-left: 12px; font-size: 1.2rem; width: 25px; text-align: center; }

        /* Content Area (Feed) */
        main.content { padding: 20px; overflow-y: auto; scroll-behavior: smooth; border-left: 1px solid #ddd; border-right: 1px solid #ddd; }
        .card { background: var(--white); border-radius: 15px; padding: 20px; box-shadow: 0 1px 3px rgba(0,0,0,0.1); margin-bottom: 20px; }
        
        /* Map Widget */
        .map-container {
            height: 180px; background: #0a192f; border-radius: 12px; position: relative;
            display: flex; align-items: center; justify-content: center; color: rgba(255,255,255,0.1);
        }
        .pulse-dot {
            position: absolute; width: 6px; height: 6px; background: var(--nexa-green);
            border-radius: 50%; animation: pulse 2s infinite;
        }

        /* --- Forensic Radar Panel --- */
        .forensic-panel { background: var(--white); padding: 20px; display: flex; flex-direction: column; gap: 15px; }
        .radar-box {
            width: 170px; height: 170px; border-radius: 50%; border: 4px solid var(--nexa-blue);
            margin: 0 auto; position: relative; overflow: hidden; background: #000;
            transition: 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }
        .sweep {
            position: absolute; width: 100%; height: 100%; top: 0; left: 0;
            background: conic-gradient(from 0deg, transparent, rgba(24, 119, 242, 0.4));
            animation: rotate 2s linear infinite;
        }
        @keyframes rotate { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }
        @keyframes pulse { 0% { transform: scale(1); opacity: 1; } 100% { transform: scale(3); opacity: 0; } }

        /* --- Chat Sovereignty --- */
        .chat-section { flex: 1; display: flex; flex-direction: column; background: #f8f9fa; border-radius: 12px; overflow: hidden; border: 1px solid #ddd; }
        .chat-msgs { flex: 1; padding: 10px; font-size: 0.75rem; overflow-y: auto; }
        .msg { background: white; padding: 8px; border-radius: 8px; margin-bottom: 10px; border-right: 3px solid var(--nexa-blue); }
        .chat-input { display: flex; background: white; border-top: 1px solid #ddd; }
        .chat-input input { flex: 1; border: none; padding: 10px; font-size: 0.8rem; outline: none; }

        /* Buttons */
        .btn { padding: 12px; border-radius: 10px; border: none; font-weight: 900; cursor: pointer; transition: 0.3s; font-family: 'Cairo'; width: 100%; }
        .btn-blue { background: var(--nexa-blue); color: white; }
        .btn-dark { background: #1c1e21; color: white; margin-top: 5px; }
        
        /* Forensic Report Alert */
        .alert-toast { display: none; background: var(--nexa-red); color: white; padding: 10px; border-radius: 8px; font-size: 0.7rem; font-weight: bold; margin-top: 10px; text-align: center; }
    </style>
</head>
<body>

    <header>
        <div class="logo">NEXA</div>
        <div style="font-size: 0.8rem; font-weight: bold; color: var(--nexa-green);">
            <i class="fas fa-satellite-dish"></i> Ø§Ù„Ø´Ø¨ÙƒØ© Ø§Ù„Ø¹Ø§Ù„Ù…ÙŠØ©: Ù†Ø´Ø·Ø©
        </div>
        <button onclick="connectWallet()" id="walletBtn" class="btn" style="width:auto; padding:8px 20px; background:var(--bg);">
            <i class="fab fa-ethereum"></i> Ø±Ø¨Ø· Ø§Ù„Ø³ÙŠØ§Ø¯Ø© Ø§Ù„Ø±Ù‚Ù…ÙŠØ©
        </button>
    </header>

    <div class="main-grid">
        <nav class="sidebar">
            <div class="nav-item active"><i class="fas fa-layer-group"></i> Ù…Ù†ØµØ© Ø§Ù„Ø£ØµÙˆÙ„</div>
            <div class="nav-item"><i class="fas fa-shield-virus"></i> Ù…Ø±ÙƒØ² Ø§Ù„Ø£Ù…Ø§Ù† Ø§Ù„Ø¬Ù†Ø§Ø¦ÙŠ</div>
            <div class="nav-item"><i class="fas fa-users-cog"></i> Ø´Ø±ÙƒØ§Ø¡ NEXA</div>
            <hr style="margin: 20px 0; opacity: 0.1;">
            <div class="card" style="padding: 10px; background: #f0f2f5; border: none;">
                <p style="font-size:0.65rem; color:#65676b;">Ø®Ø±ÙŠØ·Ø© Ø§Ù„ØªØºØ·ÙŠØ© Ø§Ù„Ø¬ÙŠÙˆØ³ÙŠØ§Ø³ÙŠØ©</p>
                <div class="map-container">
                    <i class="fas fa-globe-americas fa-4x"></i>
                    <div class="pulse-dot" style="top:30%; left:20%;"></div>
                    <div class="pulse-dot" style="top:50%; left:70%;"></div>
                    <div class="pulse-dot" style="top:40%; left:45%;"></div>
                </div>
            </div>
        </nav>

        <main class="content">
            <div class="card">
                <h3 style="font-size: 1rem; margin-bottom: 15px;">Ù†Ø¸Ø§Ù… Ø§Ù„Ø®ØªÙ… Ø§Ù„Ø¬Ø²ÙŠØ¦ÙŠ Ù„Ù„Ù…Ø­ØªÙˆÙ‰</h3>
                <button class="btn btn-blue" onclick="document.getElementById('fileInp').click()">
                    <i class="fas fa-file-signature"></i> Ø±ÙØ¹ Ù…Ù„Ù Ù„Ù„Ø®ØªÙ… Ø§Ù„ÙÙˆØ±ÙŠ (NXA Seal)
                </button>
                <input type="file" id="fileInp" hidden onchange="processNexaSeal(this)">
            </div>

            <div id="assetFeed">
                </div>
        </main>

        <aside class="forensic-panel">
            <h4 style="font-family:'Orbitron'; text-align:center; color:var(--nexa-blue);">FORENSIC HUB</h4>
            
            <div class="radar-box" id="radarUI">
                <div class="sweep"></div>
                <i class="fas fa-fingerprint" style="position:absolute; top:50%; left:50%; transform:translate(-50%,-50%); color:white; font-size:2rem;"></i>
            </div>

            <div id="radarAlert" class="alert-toast">ğŸš¨ ØªÙ… Ø±ØµØ¯ Ø§Ø³ØªØºÙ„Ø§Ù„ Ø¬Ø²ÙŠØ¦ÙŠ!</div>

            <div class="chat-section">
                <div class="chat-msgs" id="chatWindow">
                    <div class="msg" style="border-right-color: var(--nexa-green);">
                        <b>Ù†Ø¸Ø§Ù… NEXA:</b> Ù…Ø±Ø­Ø¨Ø§Ù‹ Ø¨Ùƒ ÙÙŠ ØºØ±ÙØ© Ø§Ù„Ø¯Ø±Ø¯Ø´Ø© Ø§Ù„Ø³ÙŠØ§Ø¯ÙŠØ©. Ø±Ø§Ø¯Ø§Ø± Ø§Ù„ØªØ­Ù‚ÙŠÙ‚ ÙŠØ¹Ù…Ù„ Ø§Ù„Ø¢Ù†.
                    </div>
                </div>
                <div class="chat-input">
                    <input type="text" id="chatInp" placeholder="Ø§Ø±Ø³Ù„ Ø±Ø³Ø§Ù„Ø© Ø£Ùˆ Ù…Ù„Ù Ù„Ù„ÙØ­Øµ...">
                    <button onclick="sendSecureMsg()" style="padding:10px; border:none; background:none; color:var(--nexa-blue); cursor:pointer;"><i class="fas fa-paper-plane"></i></button>
                </div>
            </div>

            <button class="btn btn-dark" onclick="document.getElementById('radarInp').click()">
                <i class="fas fa-search"></i> ÙØ­Øµ Ø¬Ù†Ø§Ø¦ÙŠ Ø®Ø§Ø±Ø¬ÙŠ
            </button>
            <input type="file" id="radarInp" hidden onchange="runForensicScan(this)">
            
            <button id="reportBtn" class="btn" style="display:none; background:var(--nexa-gold); color:black; font-size:0.7rem;" onclick="downloadReport()">
                <i class="fas fa-file-pdf"></i> ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ø¬Ù†Ø§Ø¦ÙŠ Ø§Ù„Ù‚Ø§Ù†ÙˆÙ†ÙŠ
            </button>
        </aside>
    </div>

<script>
    let wallet = null;
    const nexaRegistry = new Map();
    let lastInvolvedFile = "";

    async function connectWallet() {
        if(!window.ethereum) return alert("ÙŠØ±Ø¬Ù‰ ØªØ«Ø¨ÙŠØª MetaMask");
        const provider = new ethers.providers.Web3Provider(window.ethereum);
        const accounts = await provider.send("eth_requestAccounts", []);
        wallet = accounts[0];
        document.getElementById('walletBtn').innerText = "ØªÙ… Ø§Ù„ØªÙˆØ«ÙŠÙ‚: " + wallet.substring(0,8);
    }

    function processNexaSeal(input) {
        if(!wallet) return alert("ÙŠØ¬Ø¨ Ø±Ø¨Ø· Ø§Ù„Ù…Ø­ÙØ¸Ø© Ù„Ø®ØªÙ… Ø§Ù„Ø£ØµÙˆÙ„.");
        const file = input.files[0];
        const reader = new FileReader();
        reader.onload = (e) => {
            const hash = CryptoJS.SHA256(CryptoJS.lib.WordArray.create(e.target.result)).toString();
            nexaRegistry.set(file.name, hash);
            
            const post = `
                <div class="card" style="border-right: 5px solid var(--nexa-green);">
                    <div style="display:flex; align-items:center; gap:10px;">
                        <i class="fas fa-shield-check" style="color:var(--nexa-green);"></i>
                        <b>${file.name}</b>
                    </div>
                    <div style="font-size:0.65rem; color:#65676b; margin-top:8px; font-family:monospace; word-break:break-all;">
                        MOLECULAR_HASH: ${hash}
                    </div>
                    <div style="margin-top:10px; font-size:0.7rem; color:var(--nexa-blue);">
                        <i class="fas fa-clock"></i> ØªÙ… Ø§Ù„Ø®ØªÙ… Ø§Ù„Ø³ÙŠØ§Ø¯ÙŠ Ø¨Ù†Ø¬Ø§Ø­
                    </div>
                </div>
            `;
            document.getElementById('assetFeed').innerHTML = post + document.getElementById('assetFeed').innerHTML;
        };
        reader.readAsArrayBuffer(file);
    }

    function runForensicScan(input) {
        const file = input.files[0];
        lastInvolvedFile = file.name;
        const reader = new FileReader();
        reader.onload = (e) => {
            const currentHash = CryptoJS.SHA256(CryptoJS.lib.WordArray.create(e.target.result)).toString();
            const originalHash = nexaRegistry.get(file.name);
            const radarUI = document.getElementById('radarUI');
            const alertToast = document.getElementById('radarAlert');
            const reportBtn = document.getElementById('reportBtn');

            if(originalHash) {
                if(currentHash === originalHash) {
                    radarUI.style.borderColor = "var(--nexa-blue)";
                    radarUI.style.boxShadow = "0 0 20px var(--nexa-blue)";
                    alertToast.style.display = "none";
                    reportBtn.style.display = "none";
                    addChatMessage("Ù†Ø¸Ø§Ù… Ø§Ù„Ø±Ø§Ø¯Ø§Ø±", `ØªÙ… ÙØ­Øµ ${file.name}: Ø§Ù„Ù…Ù„Ù Ø£ØµÙ„ÙŠ ÙˆÙ…Ø·Ø§Ø¨Ù‚ Ù„Ù„Ø®ØªÙ… Ø§Ù„Ø¬Ø²ÙŠØ¦ÙŠ.`, "green");
                } else {
                    radarUI.style.borderColor = "var(--nexa-red)";
                    radarUI.style.boxShadow = "0 0 40px var(--nexa-red)";
                    alertToast.style.display = "block";
                    reportBtn.style.display = "block";
                    addChatMessage("Ø¥Ù†Ø°Ø§Ø± Ø¬Ù†Ø§Ø¦ÙŠ", `ØªØ­Ø°ÙŠØ±: ØªÙ… Ø±ØµØ¯ ØªÙ„Ø§Ø¹Ø¨ ÙÙŠ Ø¨ÙŠØ§Ù†Ø§Øª ${file.name}!`, "red");
                    // ØµÙˆØª Ø¥Ù†Ø°Ø§Ø±
                    const audio = new AudioContext();
                    const osc = audio.createOscillator();
                    osc.type = "sawtooth"; osc.connect(audio.destination);
                    osc.start(); osc.stop(audio.currentTime + 0.5);
                }
            } else {
                addChatMessage("Ù†Ø¸Ø§Ù… Ø§Ù„Ø±Ø§Ø¯Ø§Ø±", `Ø§Ù„Ù…Ù„Ù ${file.name} ØºÙŠØ± Ù…Ø³Ø¬Ù„ ÙÙŠ Ø§Ù„Ø³Ø¬Ù„ Ø§Ù„Ø³ÙŠØ§Ø¯ÙŠ Ø§Ù„Ø­Ø§Ù„ÙŠ.`, "blue");
            }
        };
        reader.readAsArrayBuffer(file);
    }

    function addChatMessage(user, msg, color) {
        const win = document.getElementById('chatWindow');
        const colorHex = color === 'red' ? 'var(--nexa-red)' : (color === 'green' ? 'var(--nexa-green)' : 'var(--nexa-blue)');
        win.innerHTML += `<div class="msg" style="border-right-color: ${colorHex}"><b>${user}:</b> ${msg}</div>`;
        win.scrollTop = win.scrollHeight;
    }

    function sendSecureMsg() {
        const inp = document.getElementById('chatInp');
        if(!inp.value) return;
        addChatMessage("Ø£Ù†Øª", inp.value, "blue");
        inp.value = "";
    }

    function downloadReport() {
        alert(`Ø¬Ø§Ø±ÙŠ Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø§Ù„ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ø¬Ù†Ø§Ø¦ÙŠ Ù„Ù€ ${lastInvolvedFile}...\nØ§Ù„ØªÙ‚Ø±ÙŠØ± ÙŠØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ Ø¨ØµÙ…Ø§Øª Ø§Ù„ØªÙ„Ø§Ø¹Ø¨ ÙˆØ¥Ø­Ø¯Ø§Ø«ÙŠØ§Øª Ø§Ù„Ø®Ø±Ù‚ Ø§Ù„Ø¬Ø²ÙŠØ¦ÙŠ.\nØªÙ… ØªÙˆØ«ÙŠÙ‚ Ù‡Ø°Ø§ Ø§Ù„ØªÙ‚Ø±ÙŠØ± ÙÙŠ Ø§Ù„Ø³Ø¬Ù„ Ø§Ù„Ø³ÙŠØ§Ø¯ÙŠ.`);
    }
</script>
</body>
</html>
