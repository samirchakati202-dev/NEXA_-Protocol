<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NEXA.SEAL V2.3 - Ù†Ø¸Ø§Ù… Ø§Ù„Ø®ØªÙ… Ø§Ù„ØªÙØ§Ø¹Ù„ÙŠ</title>
    <script src="https://cdn.jsdelivr.net/npm/web3@1.6.0/dist/web3.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body { background: #050505; color: #e5e7eb; font-family: 'Segoe UI', sans-serif; overflow-x: hidden; }
        .nexa-gradient { background: linear-gradient(135deg, #6366f1 0%, #a855f7 50%, #ec4899 100%); }
        .glass-card { background: rgba(255, 255, 255, 0.03); border: 1px solid rgba(255, 255, 255, 0.1); backdrop-filter: blur(10px); }
        .progress-bar { width: 0%; height: 4px; background: #ec4899; transition: width 0.3s; border-radius: 2px; }
        .scan-anim { position: relative; overflow: hidden; border: 2px solid #6366f1 !important; }
        .scan-anim::after { content: ""; position: absolute; top: -100%; left: 0; width: 100%; height: 100%; background: linear-gradient(to bottom, transparent, rgba(99, 102, 241, 0.4), transparent); animation: scan 1.5s infinite; }
        @keyframes scan { 0% { top: -100%; } 100% { top: 100%; } }
    </style>
</head>
<body class="p-4 md:p-10">
    <header class="text-center mb-10">
        <h1 class="text-5xl font-black italic nexa-gradient bg-clip-text text-transparent italic">NEXA.SEAL</h1>
        <p class="text-gray-500 text-xs mt-3 font-mono tracking-widest">SECURE ASSET PROTOCOL V2.3</p>
    </header>

    <div class="max-w-4xl mx-auto space-y-8">
        <div class="glass-card p-6 rounded-3xl flex justify-between items-center">
            <button id="connectBtn" class="px-6 py-3 rounded-xl font-bold bg-indigo-600 hover:bg-indigo-500 transition-all text-sm">Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ù…Ø­ÙØ¸Ø©</button>
            <div id="walletAddress" class="text-[9px] font-mono text-indigo-300 bg-white/5 p-2 rounded-lg truncate w-40 text-center italic">ØºÙŠØ± Ù…ØªØµÙ„</div>
        </div>

        <div class="glass-card p-8 rounded-[2rem] border-t-4 border-indigo-500 shadow-2xl shadow-indigo-500/10">
            <h2 class="text-xl font-black mb-6 flex items-center">
                <span class="text-indigo-500 ml-2 italic">/01</span> Ø§Ù„Ø®ØªÙ… ÙˆØ§Ù„ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø³ÙŠØ§Ø¯ÙŠ
            </h2>
            
            <input type="file" id="fileInput" class="hidden">
            <label for="fileInput" class="block w-full py-16 border-2 border-dashed border-white/10 rounded-[1.5rem] text-center cursor-pointer hover:bg-white/5 transition-all group">
                <div id="fileStatus" class="text-gray-500 italic group-hover:text-indigo-400">Ø¥Ø³Ù‚Ø§Ø· Ø§Ù„Ù…Ù„Ù Ù‡Ù†Ø§ Ù„Ø¨Ø¯Ø¡ Ø§Ù„Ø¹Ù…Ù„ÙŠØ©</div>
            </label>

            <div id="loadingArea" class="hidden mt-6 space-y-4">
                <div class="flex justify-between text-xs mb-2 italic text-indigo-300">
                    <span id="loaderText">Ø¬Ø§Ø±ÙŠ Ø­Ù‚Ù† Ø§Ù„Ø´ÙØ±Ø© Ø§Ù„Ø¬Ø²ÙŠØ¦ÙŠØ©...</span>
                    <span id="timer">03s</span>
                </div>
                <div class="w-full bg-white/10 h-1 rounded-full overflow-hidden">
                    <div id="progressBar" class="progress-bar"></div>
                </div>
            </div>

            <button id="sealBtn" disabled class="w-full mt-6 py-4 rounded-2xl font-black nexa-gradient shadow-lg opacity-30 cursor-not-allowed">
                ØªÙ€ÙˆÙ‚Ù€ÙŠÙ€Ø¹ ÙˆØ­Ù€ÙÙ€Ø¸ Ø§Ù„Ù€Ù…Ù€Ù„Ù€Ù
            </button>
        </div>

        <div class="glass-card p-8 rounded-[2rem] border-t-4 border-pink-500">
            <h2 class="text-xl font-black mb-6 flex items-center">
                <span class="text-pink-500 ml-2 italic">/02</span> Ø§Ù„Ø±Ø§Ø¯Ø§Ø± Ø§Ù„Ø¬Ù†Ø§Ø¦ÙŠ
            </h2>
            <div class="flex gap-3">
                <input type="file" id="scanInput" class="hidden">
                <label for="scanInput" class="flex-1 py-3 bg-white/5 border border-white/10 rounded-xl text-center text-[10px] cursor-pointer">Ù…Ù„Ù Ù…Ø´Ø¨ÙˆÙ‡ØŸ</label>
                <button onclick="realScan()" class="px-8 py-3 bg-pink-600 rounded-xl text-xs font-bold hover:bg-pink-500">ÙØ­Øµ ğŸ›°ï¸</button>
            </div>
            <div id="scanResult" class="mt-6 p-8 border border-white/5 rounded-2xl bg-black/40 text-center text-xs italic text-gray-500 min-h-[100px] flex items-center justify-center">
                Ø§Ù„Ø±Ø§Ø¯Ø§Ø± Ø¬Ø§Ù‡Ø² Ù„Ù„Ù…Ø³Ø­ Ø§Ù„Ø¬Ù†Ø§Ø¦ÙŠ...
            </div>
        </div>
    </div>

    <script>
        let web3;
        let account;
        const SECRET_TAG = "NEXA_SEAL_AUTHENTIC_2026";

        document.getElementById('connectBtn').onclick = async () => {
            if (window.ethereum) {
                const accounts = await ethereum.request({ method: 'eth_requestAccounts' });
                account = accounts[0];
                web3 = new Web3(window.ethereum);
                document.getElementById('walletAddress').innerText = account;
                document.getElementById('connectBtn').innerText = "Ù…ØªØµÙ„ âœ…";
                document.getElementById('sealBtn').disabled = false;
                document.getElementById('sealBtn').classList.remove('opacity-30', 'cursor-not-allowed');
            }
        };

        document.getElementById('sealBtn').onclick = async () => {
            const file = document.getElementById('fileInput').files[0];
            if (!file) return;

            try {
                // Ø·Ù„Ø¨ Ø§Ù„ØªÙˆÙ‚ÙŠØ¹
                await web3.eth.personal.sign(`Ø¨Ø±ÙˆØªÙˆÙƒÙˆÙ„ NEXA: ØªØ£ÙƒÙŠØ¯ Ù…Ù„ÙƒÙŠØ© ${file.name}`, account);
                
                // Ø¥Ø¸Ù‡Ø§Ø± Ù…Ù†Ø·Ù‚Ø© Ø§Ù„Ø¹Ø¯Ø§Ø¯
                const loadingArea = document.getElementById('loadingArea');
                const progressBar = document.getElementById('progressBar');
                const timerText = document.getElementById('timer');
                loadingArea.classList.remove('hidden');

                let timeLeft = 3;
                let width = 0;

                const interval = setInterval(() => {
                    timeLeft--;
                    width += 33.3;
                    progressBar.style.width = width + "%";
                    timerText.innerText = "0" + timeLeft + "s";

                    if (timeLeft <= 0) {
                        clearInterval(interval);
                        executeDownload(file);
                    }
                }, 1000);

            } catch (e) { alert("ØªÙ… Ø¥Ù„ØºØ§Ø¡ Ø§Ù„ØªÙˆÙ‚ÙŠØ¹"); }
        };

        function executeDownload(file) {
            const reader = new FileReader();
            reader.onload = function(e) {
                const sealedBlob = new Blob([e.target.result, SECRET_TAG], { type: file.type });
                const url = URL.createObjectURL(sealedBlob);
                
                const a = document.createElement('a');
                a.href = url;
                a.download = `SEALED_${file.name}`;
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);

                // Ø±Ø³Ø§Ù„Ø© Ø§Ù„Ù†Ø¬Ø§Ø­ Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠØ©
                document.getElementById('loadingArea').innerHTML = `
                    <div class="text-center p-4 bg-green-500/20 border border-green-500 rounded-xl text-green-400 text-xs font-bold animate-pulse">
                        âœ… ØªÙ… Ø§Ù„ØªØ­Ù…ÙŠÙ„ Ø¨Ù†Ø¬Ø§Ø­! Ø§Ù„Ù…Ù„Ù Ø§Ù„Ø¢Ù† Ù…Ø­Ù…ÙŠ Ø¨Ø®ØªÙ…Ùƒ.
                    </div>`;
            };
            reader.readAsArrayBuffer(file);
        }

        async function realScan() {
            const file = document.getElementById('scanInput').files[0];
            const resultDiv = document.getElementById('scanResult');
            if (!file) return;

            resultDiv.innerHTML = "Ø¬Ø§Ø±ÙŠ Ù…Ø³Ø­ Ø§Ù„Ø¨ÙƒØ³Ù„Ø§Øª...";
            resultDiv.classList.add('scan-anim');

            const reader = new FileReader();
            reader.onload = function(e) {
                const text = new TextDecoder().decode(e.target.result.slice(-50));
                setTimeout(() => {
                    resultDiv.classList.remove('scan-anim');
                    if (text.includes(SECRET_TAG)) {
                        resultDiv.innerHTML = `<div class="text-green-400"><p class="font-bold text-lg">âœ… Ù…Ù„Ù Ø£ØµÙ„ÙŠ</p><p class="text-[9px]">ØªÙ… Ø§ÙƒØªØ´Ø§Ù Ø§Ù„ØªÙˆÙ‚ÙŠØ¹ Ø§Ù„Ø³ÙŠØ§Ø¯ÙŠ</p></div>`;
                    } else {
                        resultDiv.innerHTML = `<div class="text-red-500 text-lg font-bold">âŒ Ù†Ø³Ø®Ø© Ù…Ù‚Ù„Ø¯Ø© Ø£Ùˆ Ù…ØªÙ„Ø§Ø¹Ø¨ Ø¨Ù‡Ø§</div>`;
                    }
                }, 2000);
            };
            reader.readAsArrayBuffer(file);
        }

        document.getElementById('fileInput').onchange = (e) => {
            document.getElementById('fileStatus').innerText = "ØªÙ… ØªØ¬Ù‡ÙŠØ²: " + e.target.files[0].name;
        };
    </script>
</body>
</html>
