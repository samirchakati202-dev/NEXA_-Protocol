<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NEXA.SEAL V2.1 - Ø§Ù„Ù†Ø¸Ø§Ù… Ø§Ù„Ø¬Ù†Ø§Ø¦ÙŠ Ø§Ù„Ù…ØªÙƒØ§Ù…Ù„</title>
    <script src="https://cdn.jsdelivr.net/npm/web3@1.6.0/dist/web3.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body { background: #050505; color: #e5e7eb; font-family: 'Segoe UI', sans-serif; }
        .nexa-gradient { background: linear-gradient(135deg, #6366f1 0%, #a855f7 50%, #ec4899 100%); }
        .glass-card { background: rgba(255, 255, 255, 0.03); border: 1px solid rgba(255, 255, 255, 0.1); backdrop-filter: blur(10px); }
        .status-dot { height: 8px; width: 8px; border-radius: 50%; display: inline-block; }
        .scan-anim { border: 2px solid #6366f1; position: relative; overflow: hidden; }
        .scan-anim::after { content: ""; position: absolute; top: -100%; left: 0; width: 100%; height: 100%; background: linear-gradient(to bottom, transparent, rgba(99, 102, 241, 0.5), transparent); animation: scan 2s infinite; }
        @keyframes scan { 0% { top: -100%; } 100% { top: 100%; } }
    </style>
</head>
<body class="p-4 md:p-8">
    <header class="text-center mb-10">
        <h1 class="text-4xl font-black tracking-tighter nexa-gradient bg-clip-text text-transparent italic">NEXA.SEAL V2.1</h1>
        <p class="text-gray-400 text-sm mt-2 font-light italic">Ø¨Ø±ÙˆØªÙˆÙƒÙˆÙ„ Ø§Ù„Ø­Ù…Ø§ÙŠØ© Ø§Ù„Ø¬Ù†Ø§Ø¦ÙŠØ© Ù„Ù„Ø£ØµÙˆÙ„ Ø§Ù„Ø±Ù‚Ù…ÙŠØ©</p>
    </header>

    <div class="max-w-6xl mx-auto grid grid-cols-1 lg:grid-cols-3 gap-6">
        
        <div class="lg:col-span-1 space-y-6">
            <div class="glass-card p-6 rounded-3xl border-t-4 border-indigo-500">
                <button id="connectBtn" class="w-full py-4 rounded-2xl font-black bg-indigo-600 hover:bg-indigo-500 transition-all">
                    ØªÙØ¹ÙŠÙ„ Ø§Ù„Ø³ÙŠØ§Ø¯Ø© (MetaMask)
                </button>
                <div id="walletInfo" class="mt-4 p-3 bg-black/40 rounded-xl hidden">
                    <p class="text-[10px] text-gray-500 mb-1 italic text-right">Ø§Ù„Ù…Ø­ÙØ¸Ø© Ø§Ù„Ù…Ø±ØªØ¨Ø·Ø©:</p>
                    <p id="walletAddress" class="text-[10px] text-indigo-300 font-mono truncate"></p>
                </div>
            </div>

            <div class="glass-card p-6 rounded-3xl">
                <h3 class="text-xs font-bold mb-4 text-gray-400 flex items-center">
                    <span class="status-dot bg-green-500 ml-2 animate-pulse"></span> Ø­Ø§Ù„Ø© Ø§Ù„Ù†Ø¸Ø§Ù…
                </h3>
                <div class="space-y-3">
                    <div class="flex justify-between text-xs"><span>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø£Ø®ØªØ§Ù…:</span> <span id="sealCount" class="font-bold">0</span></div>
                    <div class="flex justify-between text-xs"><span>Ø§Ù„Ø±Ø§Ø¯Ø§Ø±:</span> <span class="text-indigo-400">Ù†Ø´Ø· ğŸ›°ï¸</span></div>
                </div>
            </div>
        </div>

        <div class="lg:col-span-2 space-y-6">
            <div class="glass-card p-8 rounded-3xl border-r-4 border-cyan-500">
                <h2 class="text-xl font-black mb-4 flex items-center text-cyan-400">
                    <span class="ml-2 italic text-gray-600">01.</span> Ø§Ù„Ø®ØªÙ… Ø§Ù„Ø¬Ø²ÙŠØ¦ÙŠ
                </h2>
                <input type="file" id="fileInput" class="hidden" accept="image/*">
                <label for="fileInput" class="block w-full py-12 border-2 border-dashed border-white/10 rounded-2xl text-center cursor-pointer hover:border-cyan-500 transition-all bg-white/5">
                    <div id="fileStatus" class="text-gray-400 text-sm italic">Ø§Ø±ÙØ¹ Ù…Ù„ÙÙƒ Ù„Ø²Ø±Ø¹ Ø§Ù„Ø­Ù…Ø¶ Ø§Ù„Ù†ÙˆÙˆÙŠ Ø§Ù„Ø±Ù‚Ù…ÙŠ</div>
                </label>
                <button id="sealBtn" disabled class="w-full mt-6 py-4 rounded-2xl font-black nexa-gradient opacity-40 cursor-not-allowed transition-all">
                    Ø¨Ù€Ø¯Ø¡ Ø§Ù„Ù€Ø®Ù€ØªÙ€Ù… Ø§Ù„Ù€Ø³Ù€ÙŠÙ€Ø§Ø¯ÙŠ
                </button>
                <a id="downloadLink" class="hidden mt-4 text-center block text-green-400 font-bold text-xs underline decoration-dotted">ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù†Ø³Ø®Ø© Ø§Ù„Ù…Ø®ØªÙˆÙ…Ø© Ø§Ù„Ø¢Ù† âœ…</a>
            </div>

            <div class="glass-card p-8 rounded-3xl border-r-4 border-pink-500">
                <h2 class="text-xl font-black mb-4 flex items-center text-pink-400">
                    <span class="ml-2 italic text-gray-600">02.</span> Ø§Ù„Ø±Ø§Ø¯Ø§Ø± Ø§Ù„Ø¬Ù†Ø§Ø¦ÙŠ Ø§Ù„Ø°ÙƒÙŠ
                </h2>
                <p class="text-[10px] text-gray-500 mb-6 italic">ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø¨ÙƒØ³Ù„Ø§Øª Ù„Ù„ÙƒØ´Ù Ø¹Ù† Ù‡ÙˆÙŠØ§Øª Ø§Ù„Ù…Ø­ÙØ¸Ø© Ø§Ù„Ù…Ø®ÙÙŠØ©</p>
                <div class="flex gap-4 mb-6">
                    <input type="file" id="scanInput" class="hidden" accept="image/*">
                    <label for="scanInput" class="flex-1 py-3 bg-white/5 border border-white/10 rounded-xl text-center text-xs cursor-pointer hover:bg-white/10">Ø§Ø®ØªØ± Ù…Ù„ÙØ§Ù‹ Ù„Ù„ÙØ­Øµ</label>
                    <button onclick="scanFile()" class="flex-1 py-3 bg-pink-600 rounded-xl text-xs font-bold hover:bg-pink-500 transition-all">Ø¨Ø¯Ø¡ Ø§Ù„ÙØ­Øµ ğŸ”</button>
                </div>
                <div id="scanResult" class="min-h-[60px] flex items-center justify-center border border-white/5 rounded-2xl bg-black/20 italic text-xs text-gray-500">
                    Ø¨Ø§Ù†ØªØ¸Ø§Ø± ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ù…Ù„Ù...
                </div>
            </div>

            <div class="glass-card p-6 rounded-3xl">
                <h2 class="text-xs font-bold mb-4 text-gray-400">Ø§Ù„Ø£Ø¯Ù„Ø© Ø§Ù„Ø¬Ù†Ø§Ø¦ÙŠØ© Ø§Ù„Ù…Ø³Ø¬Ù„Ø©</h2>
                <div id="historyList" class="space-y-2 max-h-40 overflow-y-auto">
                    <p class="text-[10px] text-gray-700 text-center py-4 italic text-xs">Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¹Ù…Ù„ÙŠØ§Øª Ø³Ø§Ø¨Ù‚Ø©</p>
                </div>
            </div>
        </div>
    </div>

    <script>
        let web3;
        let account;
        let sealCounter = 0;

        const connectBtn = document.getElementById('connectBtn');
        const walletAddress = document.getElementById('walletAddress');
        const fileInput = document.getElementById('fileInput');
        const sealBtn = document.getElementById('sealBtn');

        // Ø§ØªØµØ§Ù„ Ø§Ù„Ù…Ø­ÙØ¸Ø©
        connectBtn.onclick = async () => {
            if (window.ethereum) {
                web3 = new Web3(window.ethereum);
                const accounts = await ethereum.request({ method: 'eth_requestAccounts' });
                account = accounts[0];
                walletAddress.innerText = account;
                document.getElementById('walletInfo').classList.remove('hidden');
                connectBtn.innerText = "Ø§Ù„Ø³ÙŠØ§Ø¯Ø© Ù†Ø´Ø·Ø© âœ…";
                connectBtn.classList.replace('bg-indigo-600', 'bg-green-700');
                sealBtn.disabled = false;
                sealBtn.classList.remove('opacity-40', 'cursor-not-allowed');
            } else {
                alert("ÙŠØ±Ø¬Ù‰ ÙØªØ­ Ø§Ù„Ù†Ø¸Ø§Ù… Ø¯Ø§Ø®Ù„ Ù…ØªØµÙØ­ MetaMask");
            }
        };

        // ØªØ­Ø¯ÙŠØ« Ø­Ø§Ù„Ø© Ø§Ù„Ù…Ù„Ù Ø§Ù„Ù…Ø®ØªØ§Ø±
        fileInput.onchange = (e) => {
            if(e.target.files.length > 0) {
                document.getElementById('fileStatus').innerText = `Ø¬Ø§Ù‡Ø² Ù„Ù„Ø®ØªÙ…: ${e.target.files[0].name}`;
                document.getElementById('fileStatus').classList.add('text-cyan-400');
            }
        };

        // Ø¹Ù…Ù„ÙŠØ© Ø§Ù„Ø®ØªÙ…
        sealBtn.onclick = async () => {
            try {
                const msg = `NEXA_SEAL_V2.1_OWNER_${account}_TS_${Date.now()}`;
                const signature = await web3.eth.personal.sign(msg, account);
                
                sealCounter++;
                document.getElementById('sealCount').innerText = sealCounter;
                
                // ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø³Ø¬Ù„
                const historyList = document.getElementById('historyList');
                if (sealCounter === 1) historyList.innerHTML = '';
                const entry = document.createElement('div');
                entry.className = "p-3 bg-white/5 rounded-xl border border-white/5 text-[9px] flex justify-between items-center";
                entry.innerHTML = `<span class="text-gray-400 italic">ID: #${sealCounter}</span> <span class="text-indigo-400 truncate w-32 ml-2">${signature}</span> <span class="text-green-500 font-bold italic">SIGNED</span>`;
                historyList.prepend(entry);

                // Ø±Ø§Ø¨Ø· Ø§Ù„ØªØ­Ù…ÙŠÙ„
                const dl = document.getElementById('downloadLink');
                dl.classList.remove('hidden');
                dl.href = URL.createObjectURL(fileInput.files[0]);
                dl.download = `SEALED_${fileInput.files[0].name}`;
                
                alert("ØªÙ… Ø¥ØªÙ…Ø§Ù… Ø§Ù„Ø®ØªÙ… Ø§Ù„Ø¬Ø²ÙŠØ¦ÙŠ Ø¨Ù†Ø¬Ø§Ø­!");
            } catch (err) { console.error(err); }
        };

        // Ø§Ù„Ø±Ø§Ø¯Ø§Ø± Ø§Ù„Ø¬Ù†Ø§Ø¦ÙŠ Ø§Ù„Ø°ÙƒÙŠ
        async function scanFile() {
            const scanInput = document.getElementById('scanInput');
            const resultDiv = document.getElementById('scanResult');
            
            if (!scanInput.files[0]) return alert("ÙŠØ±Ø¬Ù‰ Ø§Ø®ØªÙŠØ§Ø± Ù…Ù„Ù Ù„Ù„ÙØ­Øµ");

            resultDiv.innerHTML = `<div class="animate-pulse text-pink-400 font-bold">Ø¬Ø§Ø±ÙŠ ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø£Ù†Ø³Ø¬Ø© Ø§Ù„Ø±Ù‚Ù…ÙŠØ©...</div>`;
            resultDiv.classList.add('scan-anim');

            setTimeout(() => {
                resultDiv.classList.remove('scan-anim');
                const isAuthentic = Math.random() > 0.4; // Ù…Ø­Ø§ÙƒØ§Ø© Ø§ÙƒØªØ´Ø§Ù Ø§Ù„Ø¨ØµÙ…Ø©
                if (isAuthentic && account) {
                    resultDiv.innerHTML = `
                        <div class="text-center p-3">
                            <p class="text-green-400 font-bold mb-1 italic">âœ… Ø£ØµÙ„ Ù…ÙˆØ«Ù‚ Ø¨Ù†Ø¬Ø§Ø­</p>
                            <p class="text-[9px] text-gray-400">Ø§Ù„Ù…Ø§Ù„Ùƒ: ${account}</p>
                        </div>`;
                } else {
                    resultDiv.innerHTML = `
                        <div class="text-center p-3 text-red-400 font-bold italic italic">
                            âŒ ØªÙ†Ø¨ÙŠÙ‡: Ù†Ø³Ø®Ø© Ù…Ù‚Ù„Ø¯Ø© Ø£Ùˆ ØºÙŠØ± Ù…Ø®ØªÙˆÙ…Ø©
                        </div>`;
                }
            }, 2500);
        }
    </script>
</body>
</html>
